# PAUL Handoff

**Date:** 2026-02-26
**Status:** paused — clean between plans

---

## READ THIS FIRST

You have no prior context. This document tells you everything.

**Project:** axon
**Core value:** Developers and AI agents can instantly understand any codebase — files auto-indexed on change, AI agents query the DB to reduce token usage and improve response quality.

---

## Current State

**Version:** 0.2.3 (next will be 0.3.0)
**Phase:** 2 of 3 — Large Project Performance
**Plan:** 02-01 complete (loop fully closed), 02-02 not yet started

**Loop Position:**
```
PLAN ──▶ APPLY ──▶ UNIFY
  ✓        ✓        ✓     [Ready for next PLAN]
```

---

## What Was Done This Session

- Archived previous handoff (Phase 1 complete)
- Planned, applied, and unified Phase 2 Plan 02-01 (Benchmark Baseline):
  - Added `PhaseTimings` dataclass to `PipelineResult` (13 phases timed)
  - Instrumented all phases in `run_pipeline()` with `time.monotonic()`
  - Created `benchmarks/run_benchmark.py` — table + JSON output
  - 645 tests passing, no regressions

---

## What's In Progress

Nothing — Plan 02-01 loop fully closed. Plan 02-02 not yet started.

---

## What's Next

**Immediate:** `/paul:plan` for Phase 2, Plan 02-02 — Incremental Indexing (file-level delta)

**Plan 02-02 scope (from ROADMAP):**
- Skip re-parsing files whose mtime/hash has not changed since last index
- Store a file index manifest (path → mtime or content hash) in the storage backend
- On `run_pipeline()` call: diff discovered files against manifest, only parse changed/new files
- Note: `reindex_files()` already exists in `pipeline.py` — this is the partial foundation

**After that:** Plan 02-03 — Parallel parsing worker pool

---

## Baseline Benchmark Data

Run: `uv run python benchmarks/run_benchmark.py --repo-path . --no-embeddings`

```
Phase                          Duration       %
File walking                      0.32s   35.9%
Parsing code                      0.31s   35.0%
Detecting communities             0.17s   19.0%
...
Total: 0.89s (axon repo, 85 files, 1415 symbols)
```

Bottleneck on a large repo will be walking + parsing. Incremental indexing (02-02) eliminates both for unchanged files.

---

## Key Files

| File | Purpose |
|------|---------|
| `.paul/STATE.md` | Live project state — read first |
| `.paul/ROADMAP.md` | Phase overview — Phase 2 in progress |
| `.paul/phases/02-large-project-performance/02-01-SUMMARY.md` | Plan 02-01 results + baseline data |
| `src/axon/core/ingestion/pipeline.py` | Pipeline — PhaseTimings added here |
| `benchmarks/run_benchmark.py` | Benchmark CLI |

---

## Important Context for Plan 02-02

- `reindex_files()` in `pipeline.py` already re-indexes specific files (phases 2-7 only) — this handles the update path, but there's no mechanism yet to determine *which* files need re-indexing on a cold start
- The storage backend (`KuzuBackend`) has `remove_nodes_by_file()` — used by the watcher; can be reused
- The watcher already does file-local incremental updates on change events — Plan 02-02 extends this logic to initial full-index runs by persisting a file manifest
- Community detection (19% of total) is global-phase only — incremental indexing can skip it for file-local changes, same as the watcher does

---

## Resume Instructions

1. Run `/paul:resume` — it reads STATE.md and routes to exactly ONE next action
2. The suggested action will be `/paul:plan` for Phase 2, Plan 02-02
3. Plan 02-02 focus: mtime/hash manifest → skip unchanged files on index

---

*Handoff created: 2026-02-26*
